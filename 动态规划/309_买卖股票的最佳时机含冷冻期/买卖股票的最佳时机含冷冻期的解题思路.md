# 动态规划—买卖股票的最佳时机含冷冻期

## 问题分析

给定一个整数数组 `prices`，其中第 * *`prices[i]` 表示第 `<em>i</em>` 天的股票价格 。

设计一个算法计算出最大利润。在满足以下约束条件下，你可以尽可能地完成更多的交易（多次买卖一支股票）:

* 卖出股票后，你无法在第二天买入股票 (即冷冻期为 1 天)。

**注意：**你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。

设 $f(i)$ 为在第 i 天结束的累计最大收益。根据题目的限制：每天要采取买入股票或者卖出股票，以及有可能处于冷冻期的情况。所以在第 i 天，我们会有三种状态：

1. 持有股票
2. 卖出股票
3. 不持有股票

对于第一种状态，第 i - 1 天持有股票或是第 i 天买入股票，所以对

$$
f(i)_1 = \max(f(i-1)_1, \ f(i-1)_2 - prices[i] )
$$

对于第二种状态，第 i - 1 天必定持有股票，所以

$$
f(i)_2 = f(i - 1)_1 + prices[i]
$$

对于第三种状态，第 i - 1 天卖出股票或者也不持有股票，所以

$$
f(i)_3 = \max(f(i-1)_1, f(i-2)_2 )
$$


## 动态规划解法

我们定义三个状态变量：

1. `hold[i]`：表示第 `i` 天结束时，持有股票的最大利润。
2. `sold[i]`：表示第 `i` 天结束时，卖出股票并进入冷冻期的最大利润。
3. `rest[i]`：表示第 `i` 天结束时，处于冷冻期后不持有股票的最大利润（即休息的状态）。

状态转移方程：

* `hold[i] = Math.max(hold[i-1], rest[i-1] - prices[i])`：表示当天持有股票，要么是之前就持有，要么是当天买入股票。
* `sold[i] = hold[i-1] + prices[i]`：表示当天卖出股票，前一天必须持有股票。
* `rest[i] = Math.max(rest[i-1], sold[i-1])`：表示当天处于冷冻期或休息状态，要么是之前也在休息，要么是前一天卖出了股票。

初始状态：

* `hold[0] = -prices[0]`：第一天如果持有股票，那么利润为负数。
* `sold[0] = 0`：第一天卖出股票是不可能的，利润为0。
* `rest[0] = 0`：第一天休息时，利润为0。

最终结果是 `Math.max(sold[n-1], rest[n-1])`，因为最后一天的最大利润一定是不持有股票的状态，即要么在卖出股票后休息，要么就是休息状态
